{"mappings":"iiBAAA,IAAAA,EAAAC,EAAA,S,iEAMMC,EAAO,CACXC,YAAaC,SAASC,cAAc,gBACpCC,mBAAoBF,SAASC,cAAc,6BAC3CE,iBAAkBH,SAASC,cAAc,yBACzCG,eAAgBJ,SAASC,cAAc,YACvCI,mBAAoBL,SAASC,cAAc,oBAC3CK,gBAAiBN,SAASC,cAAc,cAIpCM,EAAU,IAAIC,EAAAC,GAAJ,CAAmB,cAG7BC,EAAa,IAAI,EAAAC,EAAAC,SAGjBC,EAAW,IAAIC,sBAyDrB,SAA4BC,EAASC,GACnCD,EAAQE,SAAQ,SAAAC,GACVA,EAAMC,gBAERC,EAAe,KAAMV,EAAWW,KAAO,E,MA7DiB,CAC5DC,WAAY,QACZC,UAAW,I,SAQEH,EAAeI,EAAOH,G,OAAtBI,EAAcC,MAAAC,KAAAC,U,UAAdH,I,OAAAA,EAAfjB,EAAAZ,EAAA,CAAAY,EAAAqB,GAAAC,MAAA,SAAAC,EAA8BP,EAAOH,G,IAI3BW,E,2FAAetB,EAAWuB,YAAYT,EAAOH,G,UAA7CW,EAAME,EAAAC,KAEC,IAATd,IAEFe,EAAAC,OAAOC,QAAQ,oBAAqCC,OAAjB7B,EAAW8B,MAAM,aAGpD3B,EAAS4B,QAAQ3C,EAAKO,qBAIxBP,EAAKM,eAAesC,mBAClB,YACAV,EAAOW,IAAIC,EAAAhC,SAAmBiC,KAAK,KAIrCtC,EAAQuC,YAGJpC,EAAWW,MAAQX,EAAWqC,UAAQ,C,eACxC,MAAM,IAAIC,MACR,8D,yDAKJZ,EAAAC,OAAOY,QAAQf,EAAAgB,GAAMC,SAGrBtC,EAASuC,UAAUtD,EAAKO,oB,2DAlCCqB,MAAAC,KAAAC,U,CA6D7B9B,EAAKC,YAAYsD,iBAAiB,UAElC,SAAsBC,GAEpBA,EAAMC,iBApBNzD,EAAKM,eAAeoD,UAAY,GA0BhC3C,EAASuC,UAAUtD,EAAKO,oBAGxBe,EAAekC,EAAMG,OAAOC,SAASC,YAAYC,MAAO,E","sources":["src/js/index-scroll.js"],"sourcesContent":["import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { Notify } from 'notiflix/build/notiflix-notify-aio';\nimport PixabayApi from './pixabay-api.js';\nimport photoCardTemplate from './photo-card-template.js';\n\nconst refs = {\n  formElement: document.querySelector('#search-form'),\n  searchQueryElement: document.querySelector('input[name=\"searchQuery\"]'),\n  submitBtnElement: document.querySelector('button[type=\"submit\"]'),\n  galleryElement: document.querySelector('.gallery'),\n  loadMoreBtnElement: document.querySelector('button.load-more'),\n  backdropElement: document.querySelector('.backdrop'),\n};\n\n// Initialize SimpleLightbox\nconst gallery = new SimpleLightbox('.gallery a');\n\n// Create new object to handle all requests\nconst pixabayApi = new PixabayApi();\n\n// Create observer\nconst observer = new IntersectionObserver(observeLoadMoreBtn, {\n  rootMargin: '200px',\n  threshold: 1.0,\n});\n\n/**\n  |============================\n  | Function to Process Request\n  |============================\n*/\nasync function processRequest(query, page) {\n  // Send request to a server\n  try {\n    // Fetch Photos from a server\n    const photos = await pixabayApi.fetchPhotos(query, page);\n\n    if (page === 1) {\n      // Display Total Found message only when we are on the first page\n      Notify.success(`Hooray! We found ${pixabayApi.total} images.`);\n\n      // Add observer if Scroll Mode enabled\n      observer.observe(refs.loadMoreBtnElement);\n    }\n\n    // Insert new Images to the content\n    refs.galleryElement.insertAdjacentHTML(\n      'beforeend',\n      photos.map(photoCardTemplate).join('')\n    );\n\n    // Reinitilize the lightbox\n    gallery.refresh();\n\n    // If we have reached the last page, then show message and remove observer\n    if (pixabayApi.page >= pixabayApi.lastPage) {\n      throw new Error(\n        \"We're sorry, but you've reached the end of search results.\"\n      );\n    }\n  } catch (error) {\n    // Show Error message\n    Notify.failure(error.message);\n\n    // Remove observer\n    observer.unobserve(refs.loadMoreBtnElement);\n  }\n}\n\n/**\n  |============================\n  | UI unil functions\n  |============================\n*/\n// Function to clear content\nfunction clearContent() {\n  refs.galleryElement.innerHTML = '';\n}\nfunction observeLoadMoreBtn(entries, observer) {\n  entries.forEach(entry => {\n    if (entry.isIntersecting) {\n      // Send request to the server and render HTML\n      processRequest(null, pixabayApi.page + 1);\n    }\n  });\n}\n\n/**\n  |============================\n  | Add Event Listener for Form submit event\n  |============================\n*/\nrefs.formElement.addEventListener('submit', onFormSubmit);\n\nfunction onFormSubmit(event) {\n  // Prevent default form submit action\n  event.preventDefault();\n\n  // Clear content\n  clearContent();\n\n  // Remove observer\n  observer.unobserve(refs.loadMoreBtnElement);\n\n  // Send request to the server and render HTML\n  processRequest(event.target.elements.searchQuery.value, 1);\n}\n"],"names":["$bpxeT","parcelRequire","$554df84f8b9a4bb3$var$refs","formElement","document","querySelector","searchQueryElement","submitBtnElement","galleryElement","loadMoreBtnElement","backdropElement","$554df84f8b9a4bb3$var$gallery","$parcel$interopDefault","$5IjG7","$554df84f8b9a4bb3$var$pixabayApi","$8H72y","default","$554df84f8b9a4bb3$var$observer","IntersectionObserver","entries","observer","forEach","entry","isIntersecting","$554df84f8b9a4bb3$var$processRequest","page","rootMargin","threshold","query","$554df84f8b9a4bb3$var$_processRequest","apply","this","arguments","$2TvXO","mark","_callee","photos","fetchPhotos","_ctx","sent","$h6c0i","Notify","success","concat","total","observe","insertAdjacentHTML","map","$8clWC","join","refresh","lastPage","Error","failure","t0","message","unobserve","addEventListener","event","preventDefault","innerHTML","target","elements","searchQuery","value"],"version":3,"file":"index-scroll.a5c9a826.js.map"}